var oldPermissions = {
    "VOUCHER_DOCUMENT_EDIT": 93,
    "VIEW_BOM": 50,
    "VIEW_SUPPLIER": 48,
    "MANAGE_PROCUREMENT_ORDER_INSPECTION": 103,
    "INVOICE_ABANDON": 60,
    "MANAGE_PRODUCTION": 29,
    "MACHINE_STAT": 80,
    "DELETE_MACHINE": 73,
    "REJECT_PURCHASE_ORDER": 41,
    "STAFF_ITEM_RANGE": 82,
    "VIEW_PAYMENT": 17,
    "VIEW_FINANCE_DATA": 112,
    "LOGISTICS_STOCK_AUDIT": 56,
    "MODIFY_ORDER": 5,
    "MONITOR_MACHINE_STOP": 114,
    "DELETE_CUSTOMER": 76,
    "DELETE_BILL": 65,
    "INVOICE_VIEW": 61,
    "INVOICE_CREATE": 57,
    "PROCUREMENT_ORDER_AUDIT": 36,
    "MANAGE_ORDER_DELIVERY": 95,
    "PAYMENT_AUDIT": 18,
    "ORDER_DASHBOARD": 52,
    "DELETE_ORDER": 4,
    "MODIFY_PURCHASE_ORDER": 44,
    "VIEW_ORDER_DELIVERY": 94,
    "VIEW_INVENTORY": 35,
    "MANAGE_PROCUREMENT_ORDER_SHOPPING_LIST": 98,
    "DELETE_ORDER_ATTACHMENT": 55,
    "VIEW_WAREHOUSE": 89,
    "MONITOR_MACHINE_DEBUGGING": 115,
    "VIEW_CUSTOMER": 12,
    "PURCHASE_STAT": 46,
    "STAFF_STAT": 79,
    "MANAGE_ORDER_DELIVERY_HISTORY": 97,
    "INSERT_MACHINE": 70,
    "ABANDON_BILL": 64,
    "AUDIT_MACHINE": 72,
    "ADD_CUSTOMER": 75,
    "MODIFY_MACHINE": 71,
    "CANCEL_ORDER": 3,
    "INVOICE_AUDIT": 59,
    "HIDE_COST_PRICE": 47,
    "HIDE_PRICE": 27,
    "ORDER_FINANCIAL_AUDIT": 7,
    "PLACE_PURCHASE_ORDER": 40,
    "DELETE_PURCHASE_ORDER": 43,
    "EDIT_PRODUCT_PRICE": 120,
    "MODIFY_BILL": 63,
    "INVOICE_MODIFY": 58,
    "PLACE_PRODUCTION": 30,
    "SEND_OUTSOURCE_RECORD": 100,
    "MONITOR_MACHINE_PRODUCING": 116,
    "ORDER_RECEIVING_AUDIT": 33,
    "ORDERPRODUCT_STAT": 11,
    "DELETE_SUPPLIER": 78,
    "VIEW_SELF_ORDER": 34,
    "VIEW_PRODUCTION": 28,
    "INVOICE_DELETE": 62,
    "VIEW_OUTSOURCE_ORDERS": 91,
    "MONITOR_MACHINE_ERROR": 118,
    "MANAGE_PRODUCTION_INSPECTION": 106,
    "ADD_SUPPLIER": 77,
    "MANAGE_PRODUCTION_PROCESS": 108,
    "MANAGE_MULTI_UNIT": 81,
    "COMPANY_INFO_MANAGEMENT": 24,
    "ORDER_ATTACHMENT_ADD": 69,
    "CUSTOMER_OPERATE_INVENTORY": 122,
    "VIEW_ORDER_DELIVERY_HISTORY": 96,
    "VIEW_PRODUCTION_INSPECTION": 105,
    "VOUCHER_DOCUMENT_VIEW": 92,
    "MANAGE_PROCEDURE_COST": 111,
    "VIEW_PRODUCTION_BILL": 66,
    "VIEW_PROCUREMENT_ORDER_INSPECTION": 102,
    "INVENTORY_All_MANAGEMENT": 85,
    "VIEW_PART_CUSTOMER": 110,
    "VIEW_PURCHASE_ORDER": 38,
    "VIEW_ORDER": 1,
    "PRODUCT_MANAGEMENT": 15,
    "DISTRIBUTE_TASK": 31,
    "BANKACCOUNT_MANAGEMENT": 19,
    "AUDIT_PRODUCT_PRICE": 121,
    "SYSTEM_CONFIG": 22,
    "PROCUREMENT_ORDER_DASHBOARD": 53,
    "PRODUCTION_DASHBOARD": 54,
    "REJECT_ORDER": 2,
    "VIEW_PRODUCTION_PROCESS": 107,
    "INVENTORY_PART_MANAGEMENT": 86,
    "VIEW_PART_INVENTORY": 88,
    "PROCUREMENT_ORDER_APPLY": 101,
    "BOM_MANAGEMENT": 51,
    "INVENTORY_MANAGEMENT": 16,
    "VIEW_PROCUREMENT_ORDER_SHOPPING_LIST": 99,
    "CANCEL_PURCHASE_ORDER": 42,
    "MANAGE_WAREHOUSE": 90,
    "VIEW_All_INVENTORY": 87,
    "MONITOR_MACHINE_PAUSE": 117,
    "PERMISSION_CONFIG": 26,
    "RETURN_MATERIAL": 67,
    "ORDER_AUDIT": 6,
    "PLACE_ORDER": 10,
    "VIEW_PRODUCT": 14,
    "VIEW_PRODUCT_PRICE": 119,
    "VIEW_ALL_CUSTOMER": 109,
    "VIEW_MACHINE": 74,
    "PURCHASE_FINANCIAL_AUDIT": 37,
    "PURCHASE_RECEIVING_AUDIT": 39
};

var newPermissions = {
     "PRICE_ITEM_PRICE_RETRIEVE_NOT_ALLOW": 248,
            "ITEM_UPDATE": 48,
            "ITEM_CATEGORY_DELETE": 57,
            "ORDER_INVOICE_RECORD_RETRIEVE": 30,
            "ORDER_CANCEL": 14,
            "PURCHASE_ORDER_RECEIVE_APPLICATION_UPDATE": 108,
            "ORDER_ATTACHMENT_DELETE": 343,
            "ORDER_DELIVERY_APPLICATION_OUTBOUND": 26,
            "INVENTORY_MANAGE_MOVE_INVENTORY": 160,
            "COMPANY_CATEGORY_DELETE": 142,
            "PURCHASE_QUALITY_RETRIEVE": 124,
            "EQUIPMENT_UPDATE": 184,
            "CUSTOMER_ORDERS_STATISTICS_IMPORT": 39,
            "SPECIFICATION_TEMPLATE_DELETE": 70,
            "ITEM_PRICE_LIST_CREATE": 59,
            "EQUIPMENT_CAPACITY_STATISTIC": 188,
            "FINANCE_INVOICE_MANAGE_EXPORT": 152,
            "QUALITY_WIP_QUALITY_STANDARD_RETRIEVE": 206,
            "ITEM_PRICE_LIST_AUDIT": 62,
            "COMPANY_CREATE_CUSTOMER": 335,
            "PURCHASE_RETURN_RECORD_CANCEL": 114,
            "FINANCE_RECEIVE_PAYMENT_UNDO": 148,
            "PURCHASE_ORDER_REORDER": 105,
            "ITEM_PRICE_LIST_SUBMIT": 61,
            "FINANCE_INVOICE_MANAGE_UPDATE": 332,
            "RAW_MATERIAL_PURCHASE_QUALITY": 80,
            "ORDER_IMPORT": 7,
            "ORDER_PRINT": 16,
            "PURCHASE_ORDER_CANCEL": 101,
            "FINANCE_INVOICE_MANAGE_RETRIEVE": 151,
            "ORDER_DELIVERY_APPLICATION_FINANCE_AUDIT": 25,
            "ITEM_PRICE_LIST_DELETE": 64,
            "INVENTORY_MANAGE_ADD_PLAN": 163,
            "WIP_WORK_ORDER_UPDATE": 193,
            "PURCHASE_LIST_PURCHASE": 121,
            "PURCHASE_STATISTIC_PAGE_RETRIEVE": 127,
            "QUALITY_WIP_QUALITY_MANAGE": 205,
            "COMPANY_CATEGORY_CREATE": 140,
            "ORDER_DELIVERY_APPLICATION_PRINT": 24,
            "ORDER_RETURN_RECORD_RETRIEVE": 28,
            "PURCHASE_ORDER_RECEIVE_APPLICATION_RETURN": 112,
            "UNIT_SETTING_MANAGE": 86,
            "PROCEDURE_SET_DELETE": 180,
            "ORDER_FINANCE_AUDIT": 11,
            "ORDER_DELIVERED_STATISTICS_RETRIEVE": 42,
            "COMPANY_UPDATE_CUSTOMER": 336,
            "WIP_WORK_ORDER_COMPLETE": 199,
            "WIP_PRINT_TAG": 197,
            "FINANCE_PROVIDER_ACCOUNTS_RETRIEVE": 145,
            "MRP_RETRIEVE": 87,
            "PROCEDURE_SET_CREATE": 178,
            "ORDER_DELIVERY_APPLICATION_UPDATE": 21,
            "PURCHASE_QUALITY_STATISTIC": 131,
            "ORDER_ITEM_STATISTICS_RETRIEVE": 40,
            "ORDER_REORDER": 17,
            "INVENTORY_MANAGE_RETRIEVE": 155,
            "WIP_RETURN_MATERIAL": 322,
            "FINANCE_CUSTOMER_ACCOUNTS_EXPORT": 144,
            "INVENTORY_MANAGE_ASSEMBLED_DISMANTLED": 157,
            "QUALITY_WIP_QUALITY_RETRIEVE": 204,
            "PURCHASE_ORDER_FINANCE_AUDIT": 98,
            "PURCHASE_RETURN_RECORD_OUTBOUND": 115,
            "ITEM_PRICE_LIST_UPDATE": 60,
            "COMPANY_CUSTOMER_RETRIEVE": 347,
            "PURCHASE_LIST_DELETE": 122,
            "ORDER_RETURN_RECORD_ABANDONED": 29,
            "FINANCE_INVOICE_MANAGE_CANCEL": 334,
            "WIP_WORK_ORDER_RETRIEVE": 191,
            "ITEM_IMPORT": 52,
            "COMPANY_RETRIEVE": 132,
            "ORDER_EXPORT": 6,
            "MRP_CREATE": 88,
            "SHIPMENTS_RECORD_AUDIT": 344,
            "ORDER_CREATE": 5,
            "RAW_MATERIAL_UPDATE": 81,
            "INVENTORY_MANAGE_IMPUT_OUTPUT": 156,
            "PURCHASE_ORDER_RETURN": 100,
            "SEMI_FINISHED_PRODUCT_DELETE": 76,
            "ORDER_DELIVERY_APPLICATION_CREATE": 20,
            "ITEM_EXPORT": 53,
            "UNIT_SETTING_RETRIEVE": 85,
            "RAW_MATERIAL_RETRIEVE": 78,
            "PROCEDURE_SET_UPDATE": 179,
            "ORDER_UPDATE": 9,
            "HOME_CHART_WIP": 3,
            "ORDER_PRODUCT_PROGRESS": 31,
            "MRP_DELETE": 89,
            "SEMI_FINISHED_PRODUCT_PURCHASE_QUALITY": 73,
            "PURCHASE_PAYMENT_RECORD_PAGE_RETRIEVE": 116,
            "COMPANY_CATEGORY_RETRIEVE": 139,
            "QUALITY_REPORT_RETRIEVE": 209,
            "PURCHASE_ORDER_RECEIVE_APPLICATION_RETRIEVE": 106,
            "ORDER_AUDIT": 10,
            "RAW_MATERIAL_PRINT_TAG": 82,
            "FINANCE_RECEIVE_PAYMENT_RETRIEVE": 147,
            "ORDER_DELIVERY_APPLICATION_ABANDONED": 22,
            "PURCHASE_ORDER_AUDIT": 97,
            "QUALITY_HIS_DATA_RETRIEVE": 208,
            "COMPANY_CATEGORY_UPDATE": 141,
            "EQUIPMENT_RETRIEVE": 182,
            "PURCHASE_LIST_CREATE": 120,
            "TOBE_RECEIVER_LIST_RETRIEVE": 123,
            "INVENTORY_MANAGE_ADD_PURCHASE_LIST": 162,
            "FINANCE_INVOICE_MANAGE_CREATE": 153,
            "EQUIPMENT_SETTING_STATE": 187,
            "WIP_WORK_ORDER_DISTRIBUTE": 196,
            "FINANCE_RECEIVE_PAYMENT_ADD": 149,
            "EQUIPMENT_CREATE": 183,
            "ORDER_RECEIPT_RECORD_TRANS": 33,
            "ORDER_RETURN": 13,
            "ORDER_JOIN_PLAN": 8,
            "ITEM_RETRIEVE": 45,
            "FINANCE_DATA_RETRIEVE": 154,
            "INVENTORY_MANAGE_EXPORT": 158,
            "WIP_WORK_ORDER_CANCEL": 194,
            "ORDER_CREATE_PRODUCT": 18,
            "ITEM_PRICE_LIST_EXPORT": 66,
            "PRICE_ITEM_PRICE_RETRIEVE_ALLOW": 247,
            "COMPANY_UPDATE_SUPPLIER": 339,
            "ITEM_CATEGORY_RETRIEVE": 54,
            "STAFF_SALE_STATISTICS_RETRIEVE": 44,
            "SEMI_FINISHED_PRODUCT_RETRIEVE": 71,
            "PURCHASE_ORDER_COMPLETE": 99,
            "PURCHASE_PRODUCT_STATISTIC_PAGE_RETRIEVE": 129,
            "PURCHASE_PAYMENT_RECORD_WRITE_OFF_DETAIL": 118,
            "PURCHASE_PAYMENT_RECORD_WRITE_OFF": 117,
            "ORDER_COMPLETE": 12,
            "ORDER_DELIVERY_APPLICATION_EXPORT": 23,
            "SPECIFICATION_TEMPLATE_RETRIEVE": 67,
            "ORDER_DELIVERED_STATISTICS_EXPORT": 43,
            "FINANCE_PROVIDER_ACCOUNTS_EXPORT": 146,
            "FINANCE_INVOICE_MANAGE_AUDIT": 333,
            "MRP_PRODUCT": 91,
            "PURCHASE_ORDER_RECEIVE_APPLICATION_CREATE": 107,
            "PURCHASE_ORDER_RECEIVE_APPLICATION_PRINT": 111,
            "COMPANY_IMPORT": 135,
            "ORDER_DELETE": 15,
            "DELIVERED_RECORD_RETRIEVE": 37,
            "ITEM_CREATE": 46,
            "INVENTORY_MANAGE_CHECK": 159,
            "COMPANY_CUSTOMER_SUPPLIER_RETRIEVE": 349,
            "MRP_UPDATE": 90,
            "EQUIPMENT_DELETE": 186,
            "PROCEDURE_SET_RETRIEVE": 177,
            "PURCHASE_ORDER_PRINT": 103,
            "PURCHASE_ORDER_PRINT_TAG": 104,
            "ITEM_PRICE_LIST_IMPORT": 65,
            "PURCHASE_ORDER_DELETE": 102,
            "PURCHASE_ORDER_RETRIEVE": 93,
            "PURCHASE_STATISTIC_EXPORT": 128,
            "ORDER_RETRIEVE": 4,
            "ITEM_CATEGORY_UPDATE": 56,
            "SEMI_FINISHED_PRODUCT_CREATE": 72,
            "PRICE_COST_PRICE_RETRIEVE_ALLOW": 249,
            "PRICE_COST_PRICE_RETRIEVE_NOT_ALLOW": 250,
            "ITEM_PURCHASE_QUALITY_CREATE": 47,
            "SPECIFICATION_TEMPLATE_CREATE": 68,
            "FINANCE_CUSTOMER_ACCOUNTS_RETRIEVE": 143,
            "ORDER_RECEIPT_RECORD_PAGE_RETRIEVE": 32,
            "COMPANY_EXPORT": 134,
            "COMPANY_DELETE_CUSTOMER": 337,
            "SEMI_FINISHED_PRODUCT_PRINT_TAG": 75,
            "QUALITY_WIP_QUALITY_STANDARD_MANAGE": 207,
            "ORDER_DELIVERY_APPLICATION_RETURN": 27,
            "PURCHASE_QUALITY_CREATE": 125,
            "WIP_PROCEDURE_COMPLETER": 198,
            "ORDER_ATTACHMENT_ADD": 342,
            "COMPANY_CREATE_SUPPLIER": 338,
            "ITEM_PRICE_LIST_RETURN": 63,
            "WIP_OUT_SOURCE": 200,
            "PURCHASE_ORDER_EXPORT": 95,
            "PURCHASE_ORDER_CREATE": 94,
            "RAW_MATERIAL_CREATE": 79,
            "ITEM_PRINT_TAG": 49,
            "ITEM_UPLOAD_PIC": 51,
            "RAW_MATERIAL_UPLOAD_PIC": 84,
            "COMPANY_DELETE_SUPPLIER": 340,
            "ITEM_DELETE": 50,
            "PURCHASE_PRODUCT_STATISTIC_EXPORT": 130,
            "ORDER_ITEM_STATISTICS_EXPORT": 41,
            "COMPANY_INVITE": 136,
            "PURCHASE_ORDER_UPDATE": 96,
            "ORDER_DELIVERY_APPLICATION_RETRIEVE": 19,
            "WIP_WORK_ORDER_DELETE": 195,
            "PURCHASE_LIST_RETRIEVE": 119,
            "ITEM_PRICE_LIST_RETRIEVE": 58,
            "PURCHASE_QUALITY_DELETE": 126,
            "SEMI_FINISHED_PRODUCT_UPLOAD_PIC": 77,
            "FINANCE_RECEIVE_PAYMENT_EXPORT": 150,
            "PROCEDURE_SET_MANAGE_COST": 181,
            "SPECIFICATION_TEMPLATE_UPDATE": 69,
            "TOBE_DELIVERED_LIST_OPERATE": 36,
            "EQUIPMENT_AUDIT": 185,
            "HOME_CHART_ORDER": 1,
            "PURCHASE_ORDER_RECEIVE_APPLICATION_EXPORT": 110,
            "HOME_CHART_PURCHASE": 2,
            "CUSTOMER_ORDERS_STATISTICS_RETRIEVE": 38,
            "SEMI_FINISHED_PRODUCT_UPDATE": 74,
            "ITEM_CATEGORY_CREATE": 55,
            "ORDER_RECEIPT_RECORD_TRANS_DETAIL": 34,
            "TOBE_DELIVERED_LIST_RETRIEVE": 35,
            "MRP_PURCHASE": 92,
            "WIP_WORK_ORDER_CREATE": 192,
            "PURCHASE_RETURN_RECORD_RETRIEVE": 113,
            "COMPANY_SUPPLIER_RETRIEVE": 348,
            "RAW_MATERIAL_DELETE": 83,
            "COMPANY_UPDATE_FINANCE_DATA": 341,
            "INVENTORY_MANAGE_SETTING_SAFETY": 161,
            "PURCHASE_ORDER_RECEIVE_APPLICATION_CANCEL": 109
}
require("babel-polyfill");
var xlsx = require('node-xlsx');
var fs = require('fs');
//读取文件内容
var obj = xlsx.parse(__dirname+'/authorities.xlsx');//配置excel文件的路径
var excelObj=obj[0].data;//excelObj是excel文件里第一个sheet文档的数据，obj[i].data表示excel文件第i+1个sheet文档的全部内容
excelObj = excelObj.map(v => {
    let id0 = v[0];
    let id1 = v[1];
    
    let permissions = [];
    for(let key in newPermissions) {
        permissions.push([key, newPermissions[key]]);
    }
    permissions.map(per => {
        const key = per[0];
        const value = per[1];
        if (value === id0) {
            // console.log(key);
            id0 = key;
        }
    })

    permissions = [];
    for(let i in oldPermissions) {
        permissions.push([i, oldPermissions[i]]);
    }
    permissions.map(per => {
        const key = per[0];
        const value = per[1];
        if (value === id1) {
            id1 = key;
        }
    })

    return [id0, id1];
})
// console.log(excelObj);
var buffer = xlsx.build([{name: 'new', data: excelObj }]);
fs.writeFile('new.xlsx', buffer,  (err) => {
    if (err) throw err;
    console.log('success');
});